.. _compsets:


(see the help section of the file ``<noresm_base>/cime_config/config_compsets.xml`` for details). 
The compsets can also include information on which grids are scientifically supported (see below for details). 


**frc2 compsets**: The frc2 option uses differently organized emission files. The frc2 files are located in ::
  
  <PATH_TO_INPUTDATA>/noresm/inputdata/atm/cam/chem/emis/cmip6_emissions_version20190808
  
The frc2 files were created to avoid the occurence of random mid-month model crashes. These crashes are related to the reading of emission files. To make sure that you are using the frc2 files, choose a compsets including *frc2* or if you  want to create a new compset add ::

  %FRC2
 
to NORESM2.     

CMIP6 compsets
==============
Please use the branch ``noresm2`` for reproducing CMIP6 results of NorESM2. For an overview, please see: https://noresm-docs.readthedocs.io/en/noresm2/access/releases_noresm20.html


In order to reproduce CMIP6 experiments:

- **Checkout the CMIP6 version of NorESM2**

     How to obtain this version:  
::

     git clone https://github.com/NorESMhub/NorESM.git
     cd NorESM
     git tag --list (this should give you a list of the existing tags or releases)
     git checkout release-noresm2.0.5
     ./manage_externals/checkout_externals


CMIP6 DECK
======

piControl
^^^^^
``N1850`` is the alias for the NorESM compset for pre-industrial (1850) conditions. The long name for ``N1850`` is ::
  
  1850_CAM60%NORESM_CLM50%BGC-CROP_CICE%NORESM-CMIP6_BLOM%ECO_MOSART_SGLC_SWAV_BGC%BDRDDMS

and the long name for ``N1850frc2`` is ::

  1850_CAM60%NORESM%FRC2_CLM50%BGC-CROP_CICE%NORESM-CMIP6_BLOM%ECO_MOSART_SGLC_SWAV_BGC%BDRDDMS
  
- NorESM2-LM CMIP6 piControl was generated by the use of ``N1850``
- NorESM2-MM CMIP6 piControl was generated by the use of ``N1850frc2``

- **Create a piControl case**
     In ``<noresm-base>/cime/scripts/``
     
     - NorESM2-LM:

      ::

             ./create_newcase --case ../../cases/TEST_NorESM2-LM_piControl --compset N1850 --res f19_tn14 --machine fram --project $PROJECT --user-mods-dir cmip6_noresm_DECK   


     - NorESM2-MM:  

      ::

             ./create_newcase --case ../../cases/TEST_NorESM2-MM_piControl --compset N1850frc2 --res f09_tn14 --machine fram --project $PROJECT --user-mods-dir cmip6_noresm_DECK


- **Experiment settings**
   In your case folder (e.g. TEST_NorESM2-LM_piControl or TEST_NorESM2-MM_piControl)
   
   In ``env_run.xml``:
   
   - set ``RUN_TYPE`` to ``branch`` :
   
            ::
                
                 <group id="run_begin_stop_restart">
                   <entry id="RUN_TYPE" value="branch">

   - set ``RUN_REFCASE`` to the CMIP6 piControl casename and ``RUN_REFDATE`` to the start of the CMIP6 piControl experiment (or whatever year you need), i.e.
     
        - for  NorESM2-LM:
   
              ::
              
                   <entry id="RUN_REFCASE" value="N1850_f19_tn14_20190621">
         
                   <entry id="RUN_REFDATE" value="1600-01-01">
   
        - for NorESM2-MM:
     
              ::
            
                   <entry id="RUN_REFCASE" value="N1850_f09_tn14_20190913">
         
                   <entry id="RUN_REFDATE" value="1200-01-01">
   
Overview of piControl case names, detailed setup (machine settings, node settings etc.), raw output and restart files: 

- NorESM2-LM: https://noresmhub.github.io/noresm-exp/noresm2_deck/noresm2_lm_piC.html
- NorESM2-MM: https://noresmhub.github.io/noresm-exp/noresm2_deck/noresm2_mm_piC.html

historical
^^^^^
``NHIST`` is the alias for the NorESM compset for historical (1850-2014) conditions. The long name for ``NHIST`` is ::
   
      HIST_CAM60%NORESM_CLM50%BGC-CROP_CICE%NORESM-CMIP6_MICOM%ECO_MOSART_SGLC_SWAV_BGC%BDRDDMS

and for ``NHISTfrc2`` is ::
  
     HIST_CAM60%NORESM%FRC2_CLM50%BGC-CROP_CICE%NORESM-CMIP6_MICOM%ECO_MOSART_SGLC_SWAV_BGC%BDRDDMS
  
- NorESM2-LM CMIP6 piControl was generated by the use of ``NHIST``
- NorESM2-MM CMIP6 piControl was generated by the use of ``NHISTfrc2``

- **Create a historical case**
     In ``<noresm-base>/cime/scripts/``
     
     - NorESM2-LM:

      ::

             ./create_newcase --case ../../cases/TEST_NorESM2-LM_historical --compset NHIST --res f19_tn14 --machine fram --project $PROJECT --user-mods-dir cmip6_noresm_DECK   


     - NorESM2-MM:  

      ::

             ./create_newcase --case ../../cases/TEST_NorESM2-MM_historical --compset NHISTfrc2 --res f09_tn14 --machine fram --project $PROJECT --user-mods-dir cmip6_noresm_DECK


- **Experiment settings**
   In your case folder (e.g. TEST_NorESM2-LM_historical or TEST_NorESM2-MM_historical)
   
   In ``env_run.xml``:
   
   - set ``RUN_TYPE`` to ``hybrid`` :
   
            ::
                
                 <group id="run_begin_stop_restart">
                   <entry id="RUN_TYPE" value="hybrid">

   - set ``RUN_REFCASE`` to the CMIP6 piControl casename (i.e. initial conditions) and ``RUN_REFDATE`` to the first year of the CMIP6 piControl experiment (or whatever year you need), i.e.
     
        - for  NorESM2-LM:
   
              ::
              
                   <entry id="RUN_REFCASE" value="N1850_f19_tn14_20190621">
         
                   <entry id="RUN_REFDATE" value="1600-01-01">
   
        - for NorESM2-MM:
     
              ::
            
                   <entry id="RUN_REFCASE" value="N1850_f09_tn14_20190913">
         
                   <entry id="RUN_REFDATE" value="1200-01-01">
   
Overview of historical case names, members, detailed setup (machine settings, node settings etc.), raw output and restart files: 

- NorESM2-LM: https://noresmhub.github.io/noresm-exp/noresm2_hist/noresm2_lm_hist.html
- NorESM2-MM: https://noresmhub.github.io/noresm-exp/noresm2_hist/noresm2_hist.html
